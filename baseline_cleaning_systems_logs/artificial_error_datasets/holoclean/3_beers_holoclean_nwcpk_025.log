15:33:53 - [DEBUG] - initiating session with parameters: {'db_user': 'datacleanuser', 'db_pwd': 'abcd1234', 'db_host': 'localhost', 'db_name': 'holo', 'threads': 1, 'timeout': 180000, 'seed': 45, 'learning_rate': 0.001, 'optimizer': 'adam', 'epochs': 10, 'weight_decay': 0.01, 'momentum': 0.0, 'batch_size': 1, 'weak_label_thresh': 0.99, 'domain_thresh_1': 0, 'domain_thresh_2': 0, 'max_domain': 10000, 'cor_strength': 0.6, 'nb_cor_strength': 0.8, 'feature_norm': False, 'weight_norm': False, 'estimator_epochs': 3, 'estimator_batch_size': 32, 'verbose': True, 'bias': False, 'print_fw': True, 'debug_mode': False}
15:33:53 - [ INFO] - Loaded 2410 rows with 26510 cells
15:33:53 - [DEBUG] - Time to create index: 0.00 secs
15:33:53 - [DEBUG] - Time to create index: 0.00 secs
15:33:54 - [DEBUG] - Time to create index: 0.00 secs
15:33:54 - [DEBUG] - Time to create index: 0.00 secs
15:33:54 - [DEBUG] - Time to create index: 0.00 secs
15:33:54 - [DEBUG] - Time to create index: 0.00 secs
15:33:54 - [DEBUG] - Time to create index: 0.00 secs
15:33:54 - [DEBUG] - Time to create index: 0.00 secs
15:33:54 - [DEBUG] - Time to create index: 0.00 secs
15:33:54 - [DEBUG] - Time to create index: 0.00 secs
15:33:54 - [ INFO] - DONE Loading dirty_beers_mix_0.25_holoclean.csv
15:33:54 - [DEBUG] - Time to load dataset: 0.31 secs
15:33:54 - [DEBUG] - OPENED constraints file successfully
15:33:54 - [DEBUG] - DONE pre-processing constraint: t1&t2&EQ(t1.brewery_name,t2.brewery_name)&IQ(t1.brewery_id,t2.brewery_id)
15:33:54 - [DEBUG] - DONE extracting tuples from constraint: t1&t2&EQ(t1.brewery_name,t2.brewery_name)&IQ(t1.brewery_id,t2.brewery_id)
15:33:54 - [DEBUG] - DONE parsing predicate: EQ(t1.brewery_name,t2.brewery_name)
15:33:54 - [DEBUG] - DONE parsing predicate: IQ(t1.brewery_id,t2.brewery_id)
15:33:54 - [DEBUG] - DONE pre-processing constraint: t1&t2&EQ(t1.brewery_id,t2.brewery_id)&IQ(t1.brewery_name,t2.brewery_name)
15:33:54 - [DEBUG] - DONE extracting tuples from constraint: t1&t2&EQ(t1.brewery_id,t2.brewery_id)&IQ(t1.brewery_name,t2.brewery_name)
15:33:54 - [DEBUG] - DONE parsing predicate: EQ(t1.brewery_id,t2.brewery_id)
15:33:54 - [DEBUG] - DONE parsing predicate: IQ(t1.brewery_name,t2.brewery_name)
15:33:54 - [DEBUG] - DONE pre-processing constraint: t1&t2&EQ(t1.brewery_id,t2.brewery_id)&IQ(t1.city,t2.city)
15:33:54 - [DEBUG] - DONE extracting tuples from constraint: t1&t2&EQ(t1.brewery_id,t2.brewery_id)&IQ(t1.city,t2.city)
15:33:54 - [DEBUG] - DONE parsing predicate: EQ(t1.brewery_id,t2.brewery_id)
15:33:54 - [DEBUG] - DONE parsing predicate: IQ(t1.city,t2.city)
15:33:54 - [DEBUG] - DONE pre-processing constraint: t1&t2&EQ(t1.brewery_id,t2.brewery_id)&IQ(t1.state,t2.state)
15:33:54 - [DEBUG] - DONE extracting tuples from constraint: t1&t2&EQ(t1.brewery_id,t2.brewery_id)&IQ(t1.state,t2.state)
15:33:54 - [DEBUG] - DONE parsing predicate: EQ(t1.brewery_id,t2.brewery_id)
15:33:54 - [DEBUG] - DONE parsing predicate: IQ(t1.state,t2.state)
15:33:54 - [DEBUG] - DONE pre-processing constraint: t1&t2&EQ(t1.beer_name,t2.beer_name)&EQ(t1.brewery_name,t2.brewery_name)&IQ(t1.brewery_id,t2.brewery_id)
15:33:54 - [DEBUG] - DONE extracting tuples from constraint: t1&t2&EQ(t1.beer_name,t2.beer_name)&EQ(t1.brewery_name,t2.brewery_name)&IQ(t1.brewery_id,t2.brewery_id)
15:33:54 - [DEBUG] - DONE parsing predicate: EQ(t1.beer_name,t2.beer_name)
15:33:54 - [DEBUG] - DONE parsing predicate: EQ(t1.brewery_name,t2.brewery_name)
15:33:54 - [DEBUG] - DONE parsing predicate: IQ(t1.brewery_id,t2.brewery_id)
15:33:54 - [ INFO] - DONE Loading DCs from dc_rules_holoclean.txt
15:33:54 - [DEBUG] - Time to load dirty data: 0.00 secs
15:33:54 - [DEBUG] - DONE with Error Detector: NullDetector in 0.04 secs
15:33:54 - [DEBUG] - Preparing to execute 5 queries.
15:33:54 - [DEBUG] - Starting to execute query SELECT t1._tid_ FROM "beers_nwcpk_025" as t1 WHERE   EXISTS (SELECT t2._tid_ FROM "beers_nwcpk_025" as t2 WHERE t1."brewery_name"=t2."brewery_name" AND t1."brewery_id"<>t2."brewery_id") with id 0
15:33:54 - [DEBUG] - Time to execute query with id 0: 0.00 secs
15:33:54 - [DEBUG] - Starting to execute query SELECT t1._tid_ FROM "beers_nwcpk_025" as t1 WHERE   EXISTS (SELECT t2._tid_ FROM "beers_nwcpk_025" as t2 WHERE t1."brewery_id"=t2."brewery_id" AND t1."brewery_name"<>t2."brewery_name") with id 1
15:33:54 - [DEBUG] - Time to execute query with id 1: 0.00 secs
15:33:54 - [DEBUG] - Starting to execute query SELECT t1._tid_ FROM "beers_nwcpk_025" as t1 WHERE   EXISTS (SELECT t2._tid_ FROM "beers_nwcpk_025" as t2 WHERE t1."brewery_id"=t2."brewery_id" AND t1."city"<>t2."city") with id 2
15:33:54 - [DEBUG] - Time to execute query with id 2: 0.00 secs
15:33:54 - [DEBUG] - Starting to execute query SELECT t1._tid_ FROM "beers_nwcpk_025" as t1 WHERE   EXISTS (SELECT t2._tid_ FROM "beers_nwcpk_025" as t2 WHERE t1."brewery_id"=t2."brewery_id" AND t1."state"<>t2."state") with id 3
15:33:54 - [DEBUG] - Time to execute query with id 3: 0.00 secs
15:33:54 - [DEBUG] - Starting to execute query SELECT t1._tid_ FROM "beers_nwcpk_025" as t1 WHERE   EXISTS (SELECT t2._tid_ FROM "beers_nwcpk_025" as t2 WHERE t1."beer_name"=t2."beer_name" AND t1."brewery_name"=t2."brewery_name" AND t1."brewery_id"<>t2."brewery_id") with id 4
15:33:54 - [DEBUG] - Time to execute query with id 4: 0.00 secs
15:33:54 - [DEBUG] - Time to execute 5 queries: 0.01 secs
15:33:54 - [DEBUG] - DONE with Error Detector: ViolationDetector in 0.02 secs
15:33:54 - [ INFO] - detected 2105 potentially erroneous cells
15:33:54 - [DEBUG] - Time to create index: 0.00 secs
15:33:54 - [ INFO] - DONE with error detection.
15:33:54 - [DEBUG] - Time to detect errors: 0.24 secs
15:33:59 - [DEBUG] - Time to execute query: 0.00 secs
15:33:59 - [DEBUG] - computing frequency and co-occurrence statistics from raw data...
15:33:59 - [DEBUG] - Collecting single/pair-wise statistics...
15:34:00 - [DEBUG] - DONE computing statistics in 1.74s
15:34:00 - [DEBUG] - preparing pruned co-occurring statistics...

  0%|          | 0/10 [00:00<?, ?it/s]
 20%|██        | 2/10 [00:00<00:00,  8.82it/s]
100%|██████████| 10/10 [00:00<00:00, 34.82it/s]
15:34:01 - [DEBUG] - DONE with pruned co-occurring statistics in 0.29 secs
15:34:01 - [DEBUG] - generating initial set of un-pruned domain values...

  0%|          | 0/2410 [00:00<?, ?it/s]
  6%|▋         | 151/2410 [00:00<00:01, 1503.95it/s]
 13%|█▎        | 323/2410 [00:00<00:01, 1561.38it/s]
 20%|██        | 482/2410 [00:00<00:01, 1569.31it/s]
 27%|██▋       | 649/2410 [00:00<00:01, 1592.45it/s]
 32%|███▏      | 773/2410 [00:00<00:01, 1340.42it/s]
 37%|███▋      | 895/2410 [00:00<00:01, 1300.55it/s]
 44%|████▍     | 1067/2410 [00:00<00:00, 1402.14it/s]
 50%|████▉     | 1201/2410 [00:00<00:00, 1369.89it/s]
 57%|█████▋    | 1370/2410 [00:00<00:00, 1451.48it/s]
 63%|██████▎   | 1517/2410 [00:01<00:00, 1456.85it/s]
 70%|██████▉   | 1676/2410 [00:01<00:00, 1492.26it/s]
 76%|███████▌  | 1835/2410 [00:01<00:00, 1519.71it/s]
 82%|████████▏ | 1987/2410 [00:01<00:00, 1470.10it/s]
 90%|████████▉ | 2162/2410 [00:01<00:00, 1540.54it/s]
 96%|█████████▌| 2318/2410 [00:01<00:00, 1536.58it/s]
100%|██████████| 2410/2410 [00:01<00:00, 1490.12it/s]
15:34:03 - [DEBUG] - DONE generating initial set of domain values in 1.85
15:34:03 - [DEBUG] - training posterior model for estimating domain value probabilities...
15:34:03 - [DEBUG] - DONE training posterior model in 0.02s
15:34:03 - [DEBUG] - predicting domain value probabilities from posterior model...
15:34:03 - [DEBUG] - DONE predictions in 0.00 secs, re-constructing cell domain...
15:34:03 - [DEBUG] - re-assembling final cell domain table...

0it [00:00, ?it/s]

  0%|          | 0/21362 [00:00<?, ?it/s][A
245it [00:00, 2448.40it/s]

  2%|▏         | 331/21362 [00:00<00:06, 3303.45it/s][A
679it [00:00, 2816.60it/s]

  4%|▍         | 844/21362 [00:00<00:05, 3698.41it/s][A
1051it [00:00, 3033.58it/s]

  6%|▌         | 1191/21362 [00:00<00:05, 3623.88it/s][A
1439it [00:00, 3242.98it/s]

  7%|▋         | 1530/21362 [00:00<00:05, 3547.79it/s][A
1835it [00:00, 3427.77it/s]

  9%|▉         | 1982/21362 [00:00<00:05, 3791.05it/s][A
2331it [00:00, 3777.00it/s]

 12%|█▏        | 2490/21362 [00:00<00:04, 4100.24it/s][A
2818it [00:00, 4049.25it/s]

 14%|█▍        | 2993/21362 [00:00<00:04, 4335.19it/s][A
3224it [00:00, 3941.01it/s]

 16%|█▌        | 3414/21362 [00:00<00:04, 3924.81it/s][A
3619it [00:00, 3602.12it/s]

 18%|█▊        | 3805/21362 [00:00<00:05, 3347.54it/s][A
3986it [00:01, 3130.41it/s]

 19%|█▉        | 4154/21362 [00:01<00:05, 3313.16it/s][A
4507it [00:01, 3551.80it/s]

 22%|██▏       | 4629/21362 [00:01<00:04, 3641.05it/s][A
4967it [00:01, 3811.69it/s]

 24%|██▍       | 5104/21362 [00:01<00:04, 3914.63it/s][A
5398it [00:01, 3947.72it/s]

 26%|██▌       | 5513/21362 [00:01<00:04, 3920.76it/s][A
5813it [00:01, 4001.73it/s]

 28%|██▊       | 5995/21362 [00:01<00:03, 4149.48it/s][A
6297it [00:01, 4211.46it/s]

 30%|███       | 6443/21362 [00:01<00:03, 4241.65it/s][A
6731it [00:01, 3925.70it/s]

 32%|███▏      | 6877/21362 [00:01<00:03, 3980.57it/s][A
7137it [00:01, 3917.22it/s]

 34%|███▍      | 7289/21362 [00:01<00:03, 4019.42it/s][A
7541it [00:01, 3953.08it/s]

 36%|███▌      | 7698/21362 [00:01<00:03, 4012.32it/s][A
7960it [00:02, 4014.45it/s]

 38%|███▊      | 8104/21362 [00:02<00:03, 3943.78it/s][A
8367it [00:02, 3932.39it/s]

 40%|███▉      | 8502/21362 [00:02<00:03, 3768.30it/s][A
8831it [00:02, 4119.63it/s]

 42%|████▏     | 8992/21362 [00:02<00:03, 4048.70it/s][A
9248it [00:02, 4127.20it/s]

 44%|████▍     | 9429/21362 [00:02<00:02, 4133.31it/s][A
9665it [00:02, 3857.97it/s]

 46%|████▌     | 9849/21362 [00:02<00:03, 3797.83it/s][A
10080it [00:02, 3938.13it/s]

 48%|████▊     | 10356/21362 [00:02<00:02, 4101.53it/s][A
10506it [00:02, 2672.04it/s]

 50%|█████     | 10781/21362 [00:02<00:03, 2722.51it/s][A
11067it [00:02, 3169.36it/s]

 53%|█████▎    | 11271/21362 [00:02<00:03, 3139.98it/s][A
11520it [00:03, 3481.82it/s]

 55%|█████▌    | 11838/21362 [00:03<00:02, 3624.87it/s][A
11997it [00:03, 3787.37it/s]

 57%|█████▋    | 12279/21362 [00:03<00:02, 3715.45it/s][A
12429it [00:03, 3878.38it/s]

 60%|█████▉    | 12758/21362 [00:03<00:02, 3982.93it/s][A
12869it [00:03, 4012.01it/s]

 62%|██████▏   | 13201/21362 [00:03<00:02, 4019.29it/s][A
13378it [00:03, 4280.71it/s]

 64%|██████▍   | 13634/21362 [00:03<00:01, 4063.27it/s][A
13831it [00:03, 3980.62it/s]

 66%|██████▌   | 14063/21362 [00:03<00:02, 3532.65it/s][A
14251it [00:03, 3518.73it/s]

 68%|██████▊   | 14444/21362 [00:03<00:01, 3605.45it/s][A
14674it [00:03, 3705.09it/s]

 69%|██████▉   | 14844/21362 [00:03<00:01, 3714.90it/s][A
15099it [00:03, 3844.96it/s]

 71%|███████▏  | 15231/21362 [00:03<00:01, 3697.39it/s][A
15499it [00:04, 3699.93it/s]

 73%|███████▎  | 15612/21362 [00:04<00:01, 3729.25it/s][A
15881it [00:04, 3670.36it/s]

 75%|███████▍  | 15996/21362 [00:04<00:01, 3760.74it/s][A
16341it [00:04, 3906.46it/s]

 77%|███████▋  | 16420/21362 [00:04<00:01, 3888.05it/s][A
16742it [00:04, 3680.96it/s]

 79%|███████▊  | 16814/21362 [00:04<00:01, 3729.91it/s][A
17265it [00:04, 4039.16it/s]

 81%|████████▏ | 17362/21362 [00:04<00:00, 4123.99it/s][A
17687it [00:04, 4061.53it/s]

 83%|████████▎ | 17791/21362 [00:04<00:00, 4030.94it/s][A
18112it [00:04, 4115.07it/s]

 85%|████████▌ | 18206/21362 [00:04<00:00, 4029.53it/s][A
18533it [00:04, 4058.24it/s]

 87%|████████▋ | 18624/21362 [00:04<00:00, 4068.08it/s][A
19012it [00:04, 4251.12it/s]

 90%|████████▉ | 19148/21362 [00:04<00:00, 4355.99it/s][A
19536it [00:04, 4504.28it/s]

 92%|█████████▏| 19658/21362 [00:04<00:00, 4554.39it/s][A
20037it [00:05, 4643.59it/s]

 94%|█████████▍| 20123/21362 [00:05<00:00, 4544.65it/s][A
20509it [00:05, 4159.41it/s]

 96%|█████████▋| 20584/21362 [00:05<00:00, 4157.14it/s][A
21039it [00:05, 4444.88it/s]

 99%|█████████▉| 21167/21362 [00:05<00:00, 4542.81it/s][A

100%|██████████| 21362/21362 [00:05<00:00, 3970.83it/s][A
21362it [00:05, 3915.81it/s]
15:34:09 - [DEBUG] - DONE assembling cell domain table in 6.26s
15:34:09 - [ INFO] - number of (additional) weak labels assigned from posterior model: 1511
15:34:09 - [DEBUG] - DONE generating domain and weak labels
15:34:13 - [DEBUG] - Time to create index: 0.00 secs
15:34:13 - [DEBUG] - Time to create index: 0.00 secs
15:34:13 - [DEBUG] - Time to create index: 0.00 secs
15:34:14 - [DEBUG] - Time to create table: 0.00 secs
15:34:17 - [DEBUG] - Time to create index: 0.00 secs
15:34:17 - [ INFO] - DONE with domain preparation.
15:34:17 - [DEBUG] - Time to setup the domain: 22.62 secs
15:34:17 - [DEBUG] - Time to execute query: 0.00 secs
15:34:17 - [DEBUG] - Time to execute query: 0.00 secs
15:34:17 - [DEBUG] - Time to execute query: 0.00 secs
15:34:17 - [DEBUG] - Time to execute query: 0.00 secs
15:34:17 - [DEBUG] - Time to execute query: 0.00 secs
15:34:17 - [DEBUG] - featurizing training data...
15:34:17 - [DEBUG] - Time to execute query: 0.03 secs

  0%|          | 0/21362 [00:00<?, ?it/s]
  0%|          | 68/21362 [00:00<00:31, 671.91it/s]
  1%|          | 136/21362 [00:00<00:31, 674.11it/s]
  1%|          | 189/21362 [00:00<00:34, 616.78it/s]
  1%|          | 231/21362 [00:00<00:39, 538.55it/s]
  1%|▏         | 272/21362 [00:00<00:44, 471.10it/s]
  1%|▏         | 312/21362 [00:00<00:47, 446.68it/s]
  2%|▏         | 353/21362 [00:00<00:48, 434.10it/s]
  2%|▏         | 448/21362 [00:00<00:40, 518.16it/s]
  2%|▏         | 508/21362 [00:00<00:38, 540.02it/s]
  3%|▎         | 593/21362 [00:01<00:34, 606.26it/s]
  3%|▎         | 699/21362 [00:01<00:29, 694.09it/s]
  4%|▎         | 777/21362 [00:01<00:28, 711.37it/s]
  4%|▍         | 867/21362 [00:01<00:27, 756.57it/s]
  4%|▍         | 948/21362 [00:01<00:31, 658.51it/s]
  5%|▍         | 1020/21362 [00:01<00:34, 595.54it/s]
  5%|▌         | 1085/21362 [00:01<00:35, 566.34it/s]
  6%|▌         | 1183/21362 [00:01<00:31, 643.62it/s]
  6%|▌         | 1254/21362 [00:01<00:31, 640.33it/s]
  6%|▌         | 1323/21362 [00:02<00:30, 646.49it/s]
  7%|▋         | 1391/21362 [00:02<00:31, 634.22it/s]
  7%|▋         | 1457/21362 [00:02<00:34, 576.86it/s]
  7%|▋         | 1518/21362 [00:02<00:36, 547.26it/s]
  8%|▊         | 1628/21362 [00:02<00:30, 643.81it/s]
  8%|▊         | 1701/21362 [00:02<00:33, 586.87it/s]
  8%|▊         | 1767/21362 [00:02<00:33, 579.47it/s]
  9%|▊         | 1850/21362 [00:02<00:30, 636.02it/s]
  9%|▉         | 1943/21362 [00:03<00:27, 701.69it/s]
  9%|▉         | 2025/21362 [00:03<00:26, 732.85it/s]
 10%|▉         | 2120/21362 [00:03<00:24, 784.38it/s]
 10%|█         | 2203/21362 [00:03<00:26, 735.39it/s]
 11%|█         | 2302/21362 [00:03<00:24, 793.65it/s]
 11%|█▏        | 2409/21362 [00:03<00:22, 859.59it/s]
 12%|█▏        | 2500/21362 [00:03<00:24, 784.02it/s]
 12%|█▏        | 2583/21362 [00:03<00:26, 700.42it/s]
 13%|█▎        | 2673/21362 [00:03<00:24, 749.84it/s]
 13%|█▎        | 2761/21362 [00:04<00:23, 784.36it/s]
 13%|█▎        | 2843/21362 [00:04<00:24, 751.54it/s]
 14%|█▍        | 2966/21362 [00:04<00:21, 848.15it/s]
 14%|█▍        | 3057/21362 [00:04<00:27, 661.53it/s]
 15%|█▍        | 3134/21362 [00:04<00:32, 567.14it/s]
 15%|█▍        | 3201/21362 [00:04<00:32, 558.39it/s]
 15%|█▌        | 3264/21362 [00:04<00:35, 507.83it/s]
 16%|█▌        | 3351/21362 [00:05<00:31, 578.70it/s]
 16%|█▌        | 3417/21362 [00:05<00:34, 513.83it/s]
 16%|█▋        | 3475/21362 [00:05<00:36, 484.21it/s]
 17%|█▋        | 3529/21362 [00:05<00:43, 412.52it/s]
 17%|█▋        | 3576/21362 [00:05<00:46, 380.05it/s]
 17%|█▋        | 3619/21362 [00:05<00:48, 362.86it/s]
 17%|█▋        | 3659/21362 [00:05<00:50, 353.54it/s]
 17%|█▋        | 3697/21362 [00:06<00:51, 343.76it/s]
 17%|█▋        | 3733/21362 [00:06<00:52, 338.61it/s]
 18%|█▊        | 3769/21362 [00:06<00:52, 336.11it/s]
 18%|█▊        | 3804/21362 [00:06<00:52, 334.20it/s]
 18%|█▊        | 3838/21362 [00:06<00:52, 333.63it/s]
 18%|█▊        | 3873/21362 [00:06<00:52, 335.35it/s]
 18%|█▊        | 3907/21362 [00:06<00:52, 333.41it/s]
 18%|█▊        | 3941/21362 [00:06<00:53, 326.52it/s]
 19%|█▊        | 3974/21362 [00:06<00:53, 326.19it/s]
 19%|█▉        | 4011/21362 [00:06<00:51, 337.88it/s]
 19%|█▉        | 4090/21362 [00:07<00:42, 407.75it/s]
 20%|█▉        | 4193/21362 [00:07<00:34, 496.94it/s]
 20%|█▉        | 4258/21362 [00:07<00:32, 533.04it/s]
 20%|██        | 4322/21362 [00:07<00:30, 558.89it/s]
 21%|██        | 4409/21362 [00:07<00:27, 625.20it/s]
 21%|██        | 4508/21362 [00:07<00:24, 697.59it/s]
 21%|██▏       | 4586/21362 [00:07<00:25, 657.73it/s]
 22%|██▏       | 4664/21362 [00:07<00:24, 685.00it/s]
 22%|██▏       | 4738/21362 [00:07<00:23, 699.59it/s]
 23%|██▎       | 4824/21362 [00:08<00:22, 739.15it/s]
 23%|██▎       | 4918/21362 [00:08<00:20, 785.87it/s]
 23%|██▎       | 5011/21362 [00:08<00:19, 818.80it/s]
 24%|██▍       | 5096/21362 [00:08<00:21, 766.45it/s]
 24%|██▍       | 5175/21362 [00:08<00:21, 740.88it/s]
 25%|██▍       | 5261/21362 [00:08<00:20, 772.62it/s]
 25%|██▍       | 5340/21362 [00:08<00:22, 716.29it/s]
 25%|██▌       | 5414/21362 [00:08<00:23, 685.10it/s]
 26%|██▌       | 5485/21362 [00:08<00:24, 660.96it/s]
 26%|██▌       | 5553/21362 [00:09<00:24, 650.69it/s]
 26%|██▋       | 5620/21362 [00:09<00:24, 650.96it/s]
 27%|██▋       | 5763/21362 [00:09<00:20, 774.22it/s]
 27%|██▋       | 5851/21362 [00:09<00:22, 678.92it/s]
 28%|██▊       | 5961/21362 [00:09<00:20, 766.21it/s]
 28%|██▊       | 6048/21362 [00:09<00:20, 757.91it/s]
 29%|██▊       | 6131/21362 [00:09<00:19, 762.61it/s]
 29%|██▉       | 6213/21362 [00:09<00:20, 725.44it/s]
 29%|██▉       | 6297/21362 [00:09<00:19, 755.55it/s]
 30%|██▉       | 6376/21362 [00:10<00:20, 739.07it/s]
 30%|███       | 6453/21362 [00:10<00:20, 718.12it/s]
 31%|███       | 6527/21362 [00:10<00:23, 635.96it/s]
 31%|███       | 6594/21362 [00:10<00:24, 603.31it/s]
 31%|███       | 6657/21362 [00:10<00:24, 595.77it/s]
 31%|███▏      | 6719/21362 [00:10<00:25, 570.15it/s]
 32%|███▏      | 6791/21362 [00:10<00:24, 601.99it/s]
 32%|███▏      | 6870/21362 [00:10<00:22, 647.41it/s]
 32%|███▏      | 6937/21362 [00:11<00:25, 562.77it/s]
 33%|███▎      | 7021/21362 [00:11<00:22, 623.81it/s]
 33%|███▎      | 7088/21362 [00:11<00:24, 582.81it/s]
 33%|███▎      | 7150/21362 [00:11<00:24, 579.29it/s]
 34%|███▍      | 7212/21362 [00:11<00:23, 590.79it/s]
 34%|███▍      | 7317/21362 [00:11<00:20, 679.19it/s]
 35%|███▍      | 7391/21362 [00:11<00:21, 662.25it/s]
 35%|███▍      | 7462/21362 [00:11<00:25, 554.54it/s]
 35%|███▌      | 7531/21362 [00:11<00:23, 588.02it/s]
 36%|███▌      | 7639/21362 [00:12<00:20, 676.74it/s]
 36%|███▌      | 7715/21362 [00:12<00:20, 656.37it/s]
 36%|███▋      | 7787/21362 [00:12<00:21, 617.67it/s]
 37%|███▋      | 7865/21362 [00:12<00:20, 658.10it/s]
 37%|███▋      | 7935/21362 [00:12<00:22, 594.40it/s]
 37%|███▋      | 7999/21362 [00:12<00:24, 540.27it/s]
 38%|███▊      | 8076/21362 [00:12<00:22, 592.95it/s]
 38%|███▊      | 8140/21362 [00:12<00:23, 571.17it/s]
 38%|███▊      | 8218/21362 [00:13<00:21, 616.89it/s]
 39%|███▉      | 8283/21362 [00:13<00:22, 572.48it/s]
 39%|███▉      | 8344/21362 [00:13<00:23, 549.70it/s]
 39%|███▉      | 8402/21362 [00:13<00:24, 528.14it/s]
 40%|███▉      | 8457/21362 [00:13<00:27, 470.97it/s]
 40%|███▉      | 8536/21362 [00:13<00:23, 535.63it/s]
 40%|████      | 8629/21362 [00:13<00:20, 612.17it/s]
 41%|████      | 8744/21362 [00:13<00:17, 711.55it/s]
 41%|████▏     | 8827/21362 [00:14<00:17, 701.03it/s]
 42%|████▏     | 8905/21362 [00:14<00:19, 628.13it/s]
 42%|████▏     | 8975/21362 [00:14<00:19, 628.56it/s]
 42%|████▏     | 9044/21362 [00:14<00:19, 645.07it/s]
 43%|████▎     | 9112/21362 [00:14<00:19, 617.46it/s]
 43%|████▎     | 9206/21362 [00:14<00:17, 686.59it/s]
 43%|████▎     | 9279/21362 [00:14<00:18, 648.11it/s]
 44%|████▍     | 9358/21362 [00:14<00:17, 682.21it/s]
 44%|████▍     | 9430/21362 [00:14<00:17, 682.84it/s]
 44%|████▍     | 9501/21362 [00:15<00:18, 658.02it/s]
 45%|████▍     | 9569/21362 [00:15<00:21, 558.98it/s]
 45%|████▌     | 9629/21362 [00:15<00:23, 489.43it/s]
 45%|████▌     | 9683/21362 [00:15<00:25, 451.38it/s]
 46%|████▌     | 9732/21362 [00:15<00:26, 437.28it/s]
 46%|████▌     | 9809/21362 [00:15<00:23, 501.94it/s]
 46%|████▌     | 9865/21362 [00:15<00:22, 505.61it/s]
 47%|████▋     | 9946/21362 [00:15<00:20, 567.21it/s]
 47%|████▋     | 10042/21362 [00:16<00:17, 645.33it/s]
 48%|████▊     | 10148/21362 [00:16<00:15, 729.70it/s]
 48%|████▊     | 10230/21362 [00:16<00:16, 666.92it/s]
 48%|████▊     | 10311/21362 [00:16<00:15, 701.39it/s]
 49%|████▊     | 10387/21362 [00:16<00:15, 703.67it/s]
 49%|████▉     | 10495/21362 [00:16<00:13, 784.64it/s]
 50%|████▉     | 10584/21362 [00:16<00:13, 808.73it/s]
 50%|█████     | 10701/21362 [00:16<00:12, 888.00it/s]
 51%|█████     | 10796/21362 [00:16<00:12, 846.60it/s]
 51%|█████     | 10911/21362 [00:17<00:11, 919.08it/s]
 52%|█████▏    | 11010/21362 [00:17<00:11, 938.60it/s]
 52%|█████▏    | 11108/21362 [00:17<00:11, 873.48it/s]
 52%|█████▏    | 11199/21362 [00:17<00:12, 793.93it/s]
 53%|█████▎    | 11283/21362 [00:17<00:14, 713.55it/s]
 53%|█████▎    | 11376/21362 [00:17<00:13, 766.77it/s]
 54%|█████▎    | 11457/21362 [00:17<00:12, 775.45it/s]
 54%|█████▍    | 11553/21362 [00:17<00:11, 821.06it/s]
 55%|█████▍    | 11646/21362 [00:17<00:11, 845.12it/s]
 55%|█████▍    | 11749/21362 [00:18<00:10, 890.65it/s]
 55%|█████▌    | 11841/21362 [00:18<00:11, 845.89it/s]
 56%|█████▌    | 11928/21362 [00:18<00:14, 671.22it/s]
 56%|█████▌    | 12003/21362 [00:18<00:14, 650.53it/s]
 57%|█████▋    | 12074/21362 [00:18<00:14, 658.96it/s]
 57%|█████▋    | 12156/21362 [00:18<00:13, 696.41it/s]
 57%|█████▋    | 12229/21362 [00:18<00:13, 671.67it/s]
 58%|█████▊    | 12299/21362 [00:18<00:14, 611.75it/s]
 58%|█████▊    | 12363/21362 [00:19<00:16, 551.77it/s]
 58%|█████▊    | 12445/21362 [00:19<00:14, 611.00it/s]
 59%|█████▉    | 12567/21362 [00:19<00:12, 717.62it/s]
 59%|█████▉    | 12656/21362 [00:19<00:11, 760.89it/s]
 60%|█████▉    | 12740/21362 [00:19<00:12, 707.94it/s]
 60%|██████    | 12818/21362 [00:19<00:13, 631.50it/s]
 60%|██████    | 12888/21362 [00:19<00:15, 543.51it/s]
 61%|██████    | 12958/21362 [00:19<00:14, 581.66it/s]
 61%|██████    | 13080/21362 [00:20<00:12, 689.57it/s]
 62%|██████▏   | 13172/21362 [00:20<00:10, 745.33it/s]
 62%|██████▏   | 13257/21362 [00:20<00:10, 757.80it/s]
 62%|██████▏   | 13351/21362 [00:20<00:10, 798.13it/s]
 63%|██████▎   | 13437/21362 [00:20<00:11, 692.48it/s]
 63%|██████▎   | 13513/21362 [00:20<00:12, 627.38it/s]
 64%|██████▎   | 13605/21362 [00:20<00:11, 691.76it/s]
 64%|██████▍   | 13681/21362 [00:20<00:10, 710.55it/s]
 64%|██████▍   | 13757/21362 [00:21<00:11, 678.09it/s]
 65%|██████▍   | 13829/21362 [00:21<00:13, 556.90it/s]
 65%|██████▌   | 13891/21362 [00:21<00:15, 486.42it/s]
 65%|██████▌   | 13946/21362 [00:21<00:16, 446.94it/s]
 66%|██████▌   | 13996/21362 [00:21<00:17, 419.34it/s]
 66%|██████▌   | 14042/21362 [00:21<00:17, 414.31it/s]
 66%|██████▌   | 14086/21362 [00:21<00:18, 394.18it/s]
 66%|██████▌   | 14128/21362 [00:21<00:18, 392.85it/s]
 67%|██████▋   | 14216/21362 [00:22<00:15, 470.32it/s]
 67%|██████▋   | 14271/21362 [00:22<00:15, 469.77it/s]
 67%|██████▋   | 14359/21362 [00:22<00:12, 545.64it/s]
 68%|██████▊   | 14427/21362 [00:22<00:11, 579.95it/s]
 68%|██████▊   | 14492/21362 [00:22<00:11, 591.26it/s]
 68%|██████▊   | 14556/21362 [00:22<00:11, 595.77it/s]
 68%|██████▊   | 14620/21362 [00:22<00:11, 608.36it/s]
 69%|██████▉   | 14709/21362 [00:22<00:09, 667.35it/s]
 69%|██████▉   | 14784/21362 [00:22<00:09, 681.72it/s]
 70%|██████▉   | 14855/21362 [00:23<00:09, 665.56it/s]
 70%|██████▉   | 14926/21362 [00:23<00:09, 676.94it/s]
 70%|███████   | 15028/21362 [00:23<00:08, 751.29it/s]
 71%|███████   | 15107/21362 [00:23<00:09, 653.45it/s]
 71%|███████   | 15178/21362 [00:23<00:11, 547.18it/s]
 71%|███████▏  | 15239/21362 [00:23<00:11, 537.73it/s]
 72%|███████▏  | 15298/21362 [00:23<00:11, 527.22it/s]
 72%|███████▏  | 15363/21362 [00:23<00:10, 557.63it/s]
 72%|███████▏  | 15423/21362 [00:24<00:10, 566.72it/s]
 72%|███████▏  | 15485/21362 [00:24<00:10, 580.31it/s]
 73%|███████▎  | 15548/21362 [00:24<00:09, 592.86it/s]
 73%|███████▎  | 15612/21362 [00:24<00:09, 601.20it/s]
 74%|███████▎  | 15703/21362 [00:24<00:08, 667.53it/s]
 74%|███████▍  | 15773/21362 [00:24<00:08, 640.25it/s]
 74%|███████▍  | 15840/21362 [00:24<00:09, 593.16it/s]
 75%|███████▍  | 15920/21362 [00:24<00:08, 642.53it/s]
 75%|███████▍  | 15988/21362 [00:24<00:08, 643.39it/s]
 75%|███████▌  | 16077/21362 [00:24<00:07, 701.54it/s]
 76%|███████▌  | 16151/21362 [00:25<00:07, 694.98it/s]
 76%|███████▌  | 16223/21362 [00:25<00:07, 682.20it/s]
 76%|███████▋  | 16299/21362 [00:25<00:07, 702.22it/s]
 77%|███████▋  | 16371/21362 [00:25<00:07, 646.04it/s]
 77%|███████▋  | 16438/21362 [00:25<00:08, 603.74it/s]
 77%|███████▋  | 16501/21362 [00:25<00:08, 565.39it/s]
 78%|███████▊  | 16560/21362 [00:25<00:08, 540.79it/s]
 78%|███████▊  | 16616/21362 [00:25<00:09, 511.93it/s]
 78%|███████▊  | 16669/21362 [00:26<00:09, 502.55it/s]
 78%|███████▊  | 16721/21362 [00:26<00:09, 489.44it/s]
 79%|███████▊  | 16771/21362 [00:26<00:09, 486.73it/s]
 79%|███████▉  | 16841/21362 [00:26<00:08, 533.15it/s]
 79%|███████▉  | 16897/21362 [00:26<00:08, 532.13it/s]
 79%|███████▉  | 16982/21362 [00:26<00:07, 598.35it/s]
 80%|████████  | 17094/21362 [00:26<00:06, 695.39it/s]
 80%|████████  | 17188/21362 [00:26<00:05, 754.00it/s]
 81%|████████  | 17300/21362 [00:26<00:04, 835.37it/s]
 81%|████████▏ | 17392/21362 [00:26<00:05, 764.49it/s]
 82%|████████▏ | 17476/21362 [00:27<00:05, 699.68it/s]
 82%|████████▏ | 17552/21362 [00:27<00:05, 647.31it/s]
 83%|████████▎ | 17629/21362 [00:27<00:05, 678.83it/s]
 83%|████████▎ | 17701/21362 [00:27<00:05, 614.36it/s]
 83%|████████▎ | 17767/21362 [00:27<00:05, 607.52it/s]
 83%|████████▎ | 17831/21362 [00:27<00:05, 602.77it/s]
 84%|████████▍ | 17907/21362 [00:27<00:05, 640.89it/s]
 84%|████████▍ | 18012/21362 [00:27<00:04, 725.30it/s]
 85%|████████▍ | 18090/21362 [00:28<00:05, 592.15it/s]
 85%|████████▍ | 18157/21362 [00:28<00:05, 534.42it/s]
 85%|████████▌ | 18217/21362 [00:28<00:06, 499.58it/s]
 86%|████████▌ | 18272/21362 [00:28<00:06, 464.60it/s]
 86%|████████▌ | 18323/21362 [00:28<00:06, 446.60it/s]
 86%|████████▌ | 18381/21362 [00:28<00:06, 479.60it/s]
 86%|████████▋ | 18462/21362 [00:28<00:05, 544.71it/s]
 87%|████████▋ | 18554/21362 [00:28<00:04, 620.21it/s]
 87%|████████▋ | 18624/21362 [00:29<00:04, 581.12it/s]
 87%|████████▋ | 18690/21362 [00:29<00:04, 601.99it/s]
 88%|████████▊ | 18793/21362 [00:29<00:03, 685.92it/s]
 88%|████████▊ | 18873/21362 [00:29<00:03, 716.51it/s]
 89%|████████▊ | 18950/21362 [00:29<00:03, 709.69it/s]
 89%|████████▉ | 19072/21362 [00:29<00:02, 810.11it/s]
 90%|████████▉ | 19161/21362 [00:29<00:02, 791.41it/s]
 90%|█████████ | 19246/21362 [00:29<00:02, 780.58it/s]
 91%|█████████ | 19338/21362 [00:29<00:02, 817.38it/s]
 91%|█████████ | 19427/21362 [00:30<00:02, 835.67it/s]
 91%|█████████▏| 19523/21362 [00:30<00:02, 868.82it/s]
 92%|█████████▏| 19620/21362 [00:30<00:01, 894.29it/s]
 92%|█████████▏| 19711/21362 [00:30<00:02, 806.50it/s]
 93%|█████████▎| 19795/21362 [00:30<00:02, 697.02it/s]
 93%|█████████▎| 19870/21362 [00:30<00:02, 701.60it/s]
 94%|█████████▎| 19979/21362 [00:30<00:01, 784.06it/s]
 94%|█████████▍| 20063/21362 [00:30<00:01, 781.95it/s]
 94%|█████████▍| 20145/21362 [00:31<00:01, 736.88it/s]
 95%|█████████▍| 20222/21362 [00:31<00:01, 658.78it/s]
 95%|█████████▍| 20292/21362 [00:31<00:02, 518.76it/s]
 95%|█████████▌| 20352/21362 [00:31<00:02, 448.60it/s]
 96%|█████████▌| 20455/21362 [00:31<00:01, 537.72it/s]
 96%|█████████▌| 20522/21362 [00:31<00:01, 560.94it/s]
 96%|█████████▋| 20590/21362 [00:31<00:01, 591.18it/s]
 97%|█████████▋| 20659/21362 [00:31<00:01, 617.00it/s]
 97%|█████████▋| 20796/21362 [00:32<00:00, 738.21it/s]
 98%|█████████▊| 20897/21362 [00:32<00:00, 802.27it/s]
 98%|█████████▊| 20989/21362 [00:32<00:00, 755.09it/s]
 99%|█████████▊| 21086/21362 [00:32<00:00, 807.59it/s]
 99%|█████████▉| 21184/21362 [00:32<00:00, 852.11it/s]
100%|█████████▉| 21275/21362 [00:32<00:00, 827.85it/s]
100%|██████████| 21362/21362 [00:32<00:00, 622.61it/s]
15:34:52 - [DEBUG] - Time to execute query: 0.05 secs
15:34:56 - [DEBUG] - Preparing to execute 11 queries.
15:34:56 - [DEBUG] - Starting to execute query SELECT _vid_, val_id, count(*) violations FROM   "beers_nwcpk_025" as t1, "beers_nwcpk_025" as t2, pos_values as t3 WHERE  t1._tid_ != t2._tid_   AND  t1._tid_ = t3._tid_   AND  t3.attribute = 'brewery_name'   AND  t1."brewery_id"<>t2."brewery_id"   AND  t3.rv_val = t2."brewery_name" GROUP BY _vid_, val_id with id 0
15:34:56 - [DEBUG] - Time to execute query with id 0: 0.05 secs
15:34:56 - [DEBUG] - Starting to execute query SELECT _vid_, val_id, count(*) violations FROM   "beers_nwcpk_025" as t1, "beers_nwcpk_025" as t2, pos_values as t3 WHERE  t1._tid_ != t2._tid_   AND  t1._tid_ = t3._tid_   AND  t3.attribute = 'brewery_id'   AND  t1."brewery_name"=t2."brewery_name"   AND  t3.rv_val <> t2."brewery_id" GROUP BY _vid_, val_id with id 1
15:34:57 - [DEBUG] - Time to execute query with id 1: 0.05 secs
15:34:57 - [DEBUG] - Starting to execute query SELECT _vid_, val_id, count(*) violations FROM   "beers_nwcpk_025" as t1, "beers_nwcpk_025" as t2, pos_values as t3 WHERE  t1._tid_ != t2._tid_   AND  t1._tid_ = t3._tid_   AND  t3.attribute = 'brewery_id'   AND  t1."brewery_name"<>t2."brewery_name"   AND  t3.rv_val = t2."brewery_id" GROUP BY _vid_, val_id with id 2
15:34:57 - [DEBUG] - Time to execute query with id 2: 0.05 secs
15:34:57 - [DEBUG] - Starting to execute query SELECT _vid_, val_id, count(*) violations FROM   "beers_nwcpk_025" as t1, "beers_nwcpk_025" as t2, pos_values as t3 WHERE  t1._tid_ != t2._tid_   AND  t1._tid_ = t3._tid_   AND  t3.attribute = 'brewery_name'   AND  t1."brewery_id"=t2."brewery_id"   AND  t3.rv_val <> t2."brewery_name" GROUP BY _vid_, val_id with id 3
15:34:58 - [DEBUG] - Time to execute query with id 3: 0.05 secs
15:34:58 - [DEBUG] - Starting to execute query SELECT _vid_, val_id, count(*) violations FROM   "beers_nwcpk_025" as t1, "beers_nwcpk_025" as t2, pos_values as t3 WHERE  t1._tid_ != t2._tid_   AND  t1._tid_ = t3._tid_   AND  t3.attribute = 'brewery_id'   AND  t1."city"<>t2."city"   AND  t3.rv_val = t2."brewery_id" GROUP BY _vid_, val_id with id 4
15:34:58 - [DEBUG] - Time to execute query with id 4: 0.05 secs
15:34:58 - [DEBUG] - Starting to execute query SELECT _vid_, val_id, count(*) violations FROM   "beers_nwcpk_025" as t1, "beers_nwcpk_025" as t2, pos_values as t3 WHERE  t1._tid_ != t2._tid_   AND  t1._tid_ = t3._tid_   AND  t3.attribute = 'city'   AND  t1."brewery_id"=t2."brewery_id"   AND  t3.rv_val <> t2."city" GROUP BY _vid_, val_id with id 5
15:34:58 - [DEBUG] - Time to execute query with id 5: 0.04 secs
15:34:58 - [DEBUG] - Starting to execute query SELECT _vid_, val_id, count(*) violations FROM   "beers_nwcpk_025" as t1, "beers_nwcpk_025" as t2, pos_values as t3 WHERE  t1._tid_ != t2._tid_   AND  t1._tid_ = t3._tid_   AND  t3.attribute = 'brewery_id'   AND  t1."state"<>t2."state"   AND  t3.rv_val = t2."brewery_id" GROUP BY _vid_, val_id with id 6
15:34:59 - [DEBUG] - Time to execute query with id 6: 0.00 secs
15:34:59 - [DEBUG] - Starting to execute query SELECT _vid_, val_id, count(*) violations FROM   "beers_nwcpk_025" as t1, "beers_nwcpk_025" as t2, pos_values as t3 WHERE  t1._tid_ != t2._tid_   AND  t1._tid_ = t3._tid_   AND  t3.attribute = 'state'   AND  t1."brewery_id"=t2."brewery_id"   AND  t3.rv_val <> t2."state" GROUP BY _vid_, val_id with id 7
15:34:59 - [DEBUG] - Time to execute query with id 7: 0.05 secs
15:34:59 - [DEBUG] - Starting to execute query SELECT _vid_, val_id, count(*) violations FROM   "beers_nwcpk_025" as t1, "beers_nwcpk_025" as t2, pos_values as t3 WHERE  t1._tid_ != t2._tid_   AND  t1._tid_ = t3._tid_   AND  t3.attribute = 'beer_name'   AND  t1."brewery_name"=t2."brewery_name" AND t1."brewery_id"<>t2."brewery_id"   AND  t3.rv_val = t2."beer_name" GROUP BY _vid_, val_id with id 8
15:34:59 - [DEBUG] - Time to execute query with id 8: 0.00 secs
15:34:59 - [DEBUG] - Starting to execute query SELECT _vid_, val_id, count(*) violations FROM   "beers_nwcpk_025" as t1, "beers_nwcpk_025" as t2, pos_values as t3 WHERE  t1._tid_ != t2._tid_   AND  t1._tid_ = t3._tid_   AND  t3.attribute = 'brewery_name'   AND  t1."beer_name"=t2."beer_name" AND t1."brewery_id"<>t2."brewery_id"   AND  t3.rv_val = t2."brewery_name" GROUP BY _vid_, val_id with id 9
15:34:59 - [DEBUG] - Time to execute query with id 9: 0.00 secs
15:34:59 - [DEBUG] - Starting to execute query SELECT _vid_, val_id, count(*) violations FROM   "beers_nwcpk_025" as t1, "beers_nwcpk_025" as t2, pos_values as t3 WHERE  t1._tid_ != t2._tid_   AND  t1._tid_ = t3._tid_   AND  t3.attribute = 'brewery_id'   AND  t1."beer_name"=t2."beer_name" AND t1."brewery_name"=t2."brewery_name"   AND  t3.rv_val <> t2."brewery_id" GROUP BY _vid_, val_id with id 10
15:34:59 - [DEBUG] - Time to execute query with id 10: 0.00 secs
15:34:59 - [DEBUG] - Time to execute 11 queries: 0.36 secs
15:35:04 - [DEBUG] - DONE featurization.
15:35:05 - [DEBUG] - generating weak labels...
15:35:05 - [DEBUG] - Time to execute query: 0.12 secs

  0%|          | 0/19658 [00:00<?, ?it/s]
 25%|██▍       | 4909/19658 [00:00<00:00, 49080.57it/s]
 50%|█████     | 9830/19658 [00:00<00:00, 49117.10it/s]
 76%|███████▋  | 15017/19658 [00:00<00:00, 49910.29it/s]
100%|██████████| 19658/19658 [00:00<00:00, 49959.60it/s]
15:35:05 - [DEBUG] - DONE generating weak labels.
15:35:05 - [DEBUG] - generating mask...
15:35:05 - [DEBUG] - Time to execute query: 0.03 secs

  0%|          | 0/21362 [00:00<?, ?it/s]
 33%|███▎      | 7114/21362 [00:00<00:00, 71139.90it/s]
 67%|██████▋   | 14372/21362 [00:00<00:00, 71563.49it/s]
100%|██████████| 21362/21362 [00:00<00:00, 72620.31it/s]
15:35:05 - [DEBUG] - DONE generating mask.
15:35:05 - [ INFO] - DONE setting up featurized dataset.
15:35:05 - [DEBUG] - Time to featurize data: 56.51 secs
15:35:05 - [ INFO] - DONE setting up repair model.
15:35:05 - [DEBUG] - Time to setup repair model: 56.51 secs
15:35:06 - [ INFO] - training with 19658 training examples (cells)

  0%|          | 0/10 [00:00<?, ?it/s]15:35:21 - [DEBUG] - Epoch 1, cost = 0.366422, acc = 94.11%

 10%|█         | 1/10 [00:15<02:22, 15.79s/it]15:35:36 - [DEBUG] - Epoch 2, cost = 0.248299, acc = 94.16%

 20%|██        | 2/10 [00:30<02:03, 15.49s/it]15:35:50 - [DEBUG] - Epoch 3, cost = 0.248190, acc = 94.16%

 30%|███       | 3/10 [00:44<01:45, 15.07s/it]15:36:05 - [DEBUG] - Epoch 4, cost = 0.248197, acc = 94.17%

 40%|████      | 4/10 [00:59<01:29, 14.98s/it]15:36:19 - [DEBUG] - Epoch 5, cost = 0.248199, acc = 94.17%

 50%|█████     | 5/10 [01:13<01:12, 14.56s/it]15:36:34 - [DEBUG] - Epoch 6, cost = 0.248199, acc = 94.17%

 60%|██████    | 6/10 [01:27<00:58, 14.69s/it]15:36:47 - [DEBUG] - Epoch 7, cost = 0.248199, acc = 94.17%

 70%|███████   | 7/10 [01:41<00:42, 14.30s/it]15:37:00 - [DEBUG] - Epoch 8, cost = 0.248199, acc = 94.17%

 80%|████████  | 8/10 [01:54<00:27, 13.94s/it]15:37:14 - [DEBUG] - Epoch 9, cost = 0.248199, acc = 94.17%

 90%|█████████ | 9/10 [02:08<00:13, 13.85s/it]15:37:27 - [DEBUG] - Epoch 10, cost = 0.248199, acc = 94.17%

100%|██████████| 10/10 [02:21<00:00, 13.70s/it]
15:37:27 - [ INFO] - DONE training repair model.
15:37:27 - [DEBUG] - Time to fit repair model: 166.68 secs
15:37:27 - [ INFO] - inferring on 1777 examples (cells)
15:37:28 - [DEBUG] - Time to execute query: 0.53 secs
15:37:29 - [DEBUG] - Time to create index: 0.00 secs
15:37:29 - [DEBUG] - Time to create index: 0.00 secs
15:37:29 - [ INFO] - DONE inferring repairs.
15:37:29 - [DEBUG] - Time to infer correct cell values: 2.76 secs
15:37:29 - [DEBUG] - Time to create table: 0.00 secs
15:37:29 - [DEBUG] - Time to create index: 0.00 secs
15:37:29 - [DEBUG] - Time to create index: 0.00 secs
15:37:29 - [ INFO] - DONE collecting the inferred values.
15:37:29 - [DEBUG] - Time to collect inferred values: 0.04 secs
15:37:30 - [ INFO] - DONE generating repaired dataset
15:37:30 - [DEBUG] - Time to store repaired dataset: 0.25 secs
15:37:30 - [ INFO] - featurizer InitAttrFeaturizer,size 10,max 1.0000,min 1.0000,avg 1.0000,abs_avg 1.0000,weights:
id 1.0
beer_name 1.0
style 1.0
ounces 1.0
abv 1.0
ibu 1.0
brewery_id 1.0
brewery_name 1.0
city 1.0
state 1.0
featurizer OccurAttrFeaturizer,size 100,max 2.0186,min -0.5615,avg 0.2084,abs_avg 0.2544,weights:
id X id 0.0
id X beer_name 0.0
id X style -0.0
id X ounces 0.0
id X abv -0.0
id X ibu -0.0
id X brewery_id -0.0
id X brewery_name -0.0
id X city -0.0
id X state -0.0
beer_name X id 2.019
beer_name X beer_name -0.0
beer_name X style 0.1
beer_name X ounces 0.001
beer_name X abv 0.071
beer_name X ibu 0.068
beer_name X brewery_id 0.171
beer_name X brewery_name 0.177
beer_name X city 0.045
beer_name X state 0.0
style X id 1.098
style X beer_name 1.095
style X style 0.0
style X ounces 0.008
style X abv 0.101
style X ibu 0.117
style X brewery_id 0.126
style X brewery_name 0.131
style X city 0.065
style X state 0.009
ounces X id -0.118
ounces X beer_name -0.132
ounces X style -0.561
ounces X ounces -0.0
ounces X abv -0.562
ounces X ibu -0.245
ounces X brewery_id -0.04
ounces X brewery_name -0.062
ounces X city -0.217
ounces X state -0.357
abv X id 0.924
abv X beer_name 0.914
abv X style 0.05
abv X ounces -0.003
abv X abv -0.0
abv X ibu 0.042
abv X brewery_id 0.097
abv X brewery_name 0.105
abv X city 0.071
abv X state 0.007
ibu X id 0.861
ibu X beer_name 0.857
ibu X style 0.035
ibu X ounces 0.002
ibu X abv 0.034
ibu X ibu 0.0
ibu X brewery_id 0.111
ibu X brewery_name 0.112
ibu X city 0.061
ibu X state -0.0
brewery_id X id 0.952
brewery_id X beer_name 0.94
brewery_id X style 0.069
brewery_id X ounces 0.025
brewery_id X abv 0.055
brewery_id X ibu 0.059
brewery_id X brewery_id -0.0
brewery_id X brewery_name 0.952
brewery_id X city 0.6
brewery_id X state 0.015
brewery_name X id 0.974
brewery_name X beer_name 0.963
brewery_name X style 0.069
brewery_name X ounces 0.022
brewery_name X abv 0.053
brewery_name X ibu 0.057
brewery_name X brewery_id 0.974
brewery_name X brewery_name 0.0
brewery_name X city 0.606
brewery_name X state 0.013
city X id 0.795
city X beer_name 0.784
city X style 0.052
city X ounces 0.014
city X abv 0.036
city X ibu 0.051
city X brewery_id 0.795
city X brewery_name 0.775
city X city -0.0
city X state 0.05
state X id 0.503
state X beer_name 0.504
state X style 0.043
state X ounces 0.02
state X abv 0.039
state X ibu 0.037
state X brewery_id 0.524
state X brewery_name 0.521
state X city 0.518
state X state -0.0
featurizer FreqFeaturizer,size 10,max 0.0313,min -0.6922,avg -0.0626,abs_avg 0.0766,weights:
id -0.0
beer_name -0.0
style 0.005
ounces -0.692
abv -0.004
ibu 0.005
brewery_id 0.004
brewery_name 0.004
city 0.02
state 0.031
featurizer ConstraintFeaturizer,size 11,max -0.0000,min -0.2091,avg -0.1179,abs_avg 0.1179,weights:
fixed pred: t1."brewery_id"<>t2."brewery_id", violation pred: t1."brewery_name"=t2."brewery_name" -0.15
fixed pred: t1."brewery_name"=t2."brewery_name", violation pred: t1."brewery_id"<>t2."brewery_id" -0.205
fixed pred: t1."brewery_name"<>t2."brewery_name", violation pred: t1."brewery_id"=t2."brewery_id" -0.158
fixed pred: t1."brewery_id"=t2."brewery_id", violation pred: t1."brewery_name"<>t2."brewery_name" -0.199
fixed pred: t1."city"<>t2."city", violation pred: t1."brewery_id"=t2."brewery_id" -0.149
fixed pred: t1."brewery_id"=t2."brewery_id", violation pred: t1."city"<>t2."city" -0.194
fixed pred: t1."state"<>t2."state", violation pred: t1."brewery_id"=t2."brewery_id" -0.032
fixed pred: t1."brewery_id"=t2."brewery_id", violation pred: t1."state"<>t2."state" -0.209
fixed pred: t1."brewery_name"=t2."brewery_name" AND t1."brewery_id"<>t2."brewery_id", violation pred: t1."beer_name"=t2."beer_name" -0.0
fixed pred: t1."beer_name"=t2."beer_name" AND t1."brewery_id"<>t2."brewery_id", violation pred: t1."brewery_name"=t2."brewery_name" -0.0
fixed pred: t1."beer_name"=t2."beer_name" AND t1."brewery_name"=t2."brewery_name", violation pred: t1."brewery_id"<>t2."brewery_id" -0.001

15:37:30 - [DEBUG] - Time to store featurizer weights: 0.00 secs
15:37:33 - [DEBUG] - Time to create index: 0.00 secs
15:37:33 - [DEBUG] - Time to create index: 0.00 secs
15:37:33 - [ INFO] - DONE Loading clean_index_holoclean.csv
15:37:33 - [DEBUG] - Time to evaluate repairs: 1.55 secs
15:37:33 - [DEBUG] - Time to execute query: 0.00 secs
15:37:33 - [DEBUG] - Time to execute query: 0.00 secs
15:37:33 - [DEBUG] - Preparing to execute 10 queries.
15:37:33 - [DEBUG] - Starting to execute query SELECT count(*) FROM  "beers_nwcpk_025" as t1, "beers_nwcpk_025_clean" as t2 WHERE t1._tid_ = t2._tid_   AND t2._attribute_ = 'id'   AND t1."id" != t2._value_ with id 0
15:37:33 - [DEBUG] - Time to execute query with id 0: 0.00 secs
15:37:33 - [DEBUG] - Starting to execute query SELECT count(*) FROM  "beers_nwcpk_025" as t1, "beers_nwcpk_025_clean" as t2 WHERE t1._tid_ = t2._tid_   AND t2._attribute_ = 'beer_name'   AND t1."beer_name" != t2._value_ with id 1
15:37:33 - [DEBUG] - Time to execute query with id 1: 0.00 secs
15:37:33 - [DEBUG] - Starting to execute query SELECT count(*) FROM  "beers_nwcpk_025" as t1, "beers_nwcpk_025_clean" as t2 WHERE t1._tid_ = t2._tid_   AND t2._attribute_ = 'style'   AND t1."style" != t2._value_ with id 2
15:37:33 - [DEBUG] - Time to execute query with id 2: 0.00 secs
15:37:33 - [DEBUG] - Starting to execute query SELECT count(*) FROM  "beers_nwcpk_025" as t1, "beers_nwcpk_025_clean" as t2 WHERE t1._tid_ = t2._tid_   AND t2._attribute_ = 'ounces'   AND t1."ounces" != t2._value_ with id 3
15:37:33 - [DEBUG] - Time to execute query with id 3: 0.00 secs
15:37:33 - [DEBUG] - Starting to execute query SELECT count(*) FROM  "beers_nwcpk_025" as t1, "beers_nwcpk_025_clean" as t2 WHERE t1._tid_ = t2._tid_   AND t2._attribute_ = 'abv'   AND t1."abv" != t2._value_ with id 4
15:37:33 - [DEBUG] - Time to execute query with id 4: 0.00 secs
15:37:33 - [DEBUG] - Starting to execute query SELECT count(*) FROM  "beers_nwcpk_025" as t1, "beers_nwcpk_025_clean" as t2 WHERE t1._tid_ = t2._tid_   AND t2._attribute_ = 'ibu'   AND t1."ibu" != t2._value_ with id 5
15:37:33 - [DEBUG] - Time to execute query with id 5: 0.00 secs
15:37:33 - [DEBUG] - Starting to execute query SELECT count(*) FROM  "beers_nwcpk_025" as t1, "beers_nwcpk_025_clean" as t2 WHERE t1._tid_ = t2._tid_   AND t2._attribute_ = 'brewery_id'   AND t1."brewery_id" != t2._value_ with id 6
15:37:33 - [DEBUG] - Time to execute query with id 6: 0.00 secs
15:37:33 - [DEBUG] - Starting to execute query SELECT count(*) FROM  "beers_nwcpk_025" as t1, "beers_nwcpk_025_clean" as t2 WHERE t1._tid_ = t2._tid_   AND t2._attribute_ = 'brewery_name'   AND t1."brewery_name" != t2._value_ with id 7
15:37:33 - [DEBUG] - Time to execute query with id 7: 0.00 secs
15:37:33 - [DEBUG] - Starting to execute query SELECT count(*) FROM  "beers_nwcpk_025" as t1, "beers_nwcpk_025_clean" as t2 WHERE t1._tid_ = t2._tid_   AND t2._attribute_ = 'city'   AND t1."city" != t2._value_ with id 8
15:37:33 - [DEBUG] - Time to execute query with id 8: 0.00 secs
15:37:33 - [DEBUG] - Starting to execute query SELECT count(*) FROM  "beers_nwcpk_025" as t1, "beers_nwcpk_025_clean" as t2 WHERE t1._tid_ = t2._tid_   AND t2._attribute_ = 'state'   AND t1."state" != t2._value_ with id 9
15:37:33 - [DEBUG] - Time to execute query with id 9: 0.00 secs
15:37:33 - [DEBUG] - Time to execute 10 queries: 0.01 secs
15:37:33 - [DEBUG] - Time to execute query: 0.00 secs
15:37:33 - [DEBUG] - Preparing to execute 10 queries.
15:37:33 - [DEBUG] - Starting to execute query SELECT COUNT(*) FROM   (SELECT t2._tid_, t2._attribute_, t2._value_      FROM "beers_nwcpk_025" as t1, "beers_nwcpk_025_clean" as t2     WHERE t1._tid_ = t2._tid_       AND t2._attribute_ = 'id'       AND t1."id" != t2._value_ ) as errors, inf_values_dom as repairs WHERE errors._tid_ = repairs._tid_   AND errors._attribute_ = repairs.attribute   AND errors._value_ = repairs.rv_value with id 0
15:37:33 - [DEBUG] - Time to execute query with id 0: 0.00 secs
15:37:33 - [DEBUG] - Starting to execute query SELECT COUNT(*) FROM   (SELECT t2._tid_, t2._attribute_, t2._value_      FROM "beers_nwcpk_025" as t1, "beers_nwcpk_025_clean" as t2     WHERE t1._tid_ = t2._tid_       AND t2._attribute_ = 'beer_name'       AND t1."beer_name" != t2._value_ ) as errors, inf_values_dom as repairs WHERE errors._tid_ = repairs._tid_   AND errors._attribute_ = repairs.attribute   AND errors._value_ = repairs.rv_value with id 1
15:37:33 - [DEBUG] - Time to execute query with id 1: 0.00 secs
15:37:33 - [DEBUG] - Starting to execute query SELECT COUNT(*) FROM   (SELECT t2._tid_, t2._attribute_, t2._value_      FROM "beers_nwcpk_025" as t1, "beers_nwcpk_025_clean" as t2     WHERE t1._tid_ = t2._tid_       AND t2._attribute_ = 'style'       AND t1."style" != t2._value_ ) as errors, inf_values_dom as repairs WHERE errors._tid_ = repairs._tid_   AND errors._attribute_ = repairs.attribute   AND errors._value_ = repairs.rv_value with id 2
15:37:33 - [DEBUG] - Time to execute query with id 2: 0.00 secs
15:37:33 - [DEBUG] - Starting to execute query SELECT COUNT(*) FROM   (SELECT t2._tid_, t2._attribute_, t2._value_      FROM "beers_nwcpk_025" as t1, "beers_nwcpk_025_clean" as t2     WHERE t1._tid_ = t2._tid_       AND t2._attribute_ = 'ounces'       AND t1."ounces" != t2._value_ ) as errors, inf_values_dom as repairs WHERE errors._tid_ = repairs._tid_   AND errors._attribute_ = repairs.attribute   AND errors._value_ = repairs.rv_value with id 3
15:37:33 - [DEBUG] - Time to execute query with id 3: 0.00 secs
15:37:33 - [DEBUG] - Starting to execute query SELECT COUNT(*) FROM   (SELECT t2._tid_, t2._attribute_, t2._value_      FROM "beers_nwcpk_025" as t1, "beers_nwcpk_025_clean" as t2     WHERE t1._tid_ = t2._tid_       AND t2._attribute_ = 'abv'       AND t1."abv" != t2._value_ ) as errors, inf_values_dom as repairs WHERE errors._tid_ = repairs._tid_   AND errors._attribute_ = repairs.attribute   AND errors._value_ = repairs.rv_value with id 4
15:37:33 - [DEBUG] - Time to execute query with id 4: 0.00 secs
15:37:33 - [DEBUG] - Starting to execute query SELECT COUNT(*) FROM   (SELECT t2._tid_, t2._attribute_, t2._value_      FROM "beers_nwcpk_025" as t1, "beers_nwcpk_025_clean" as t2     WHERE t1._tid_ = t2._tid_       AND t2._attribute_ = 'ibu'       AND t1."ibu" != t2._value_ ) as errors, inf_values_dom as repairs WHERE errors._tid_ = repairs._tid_   AND errors._attribute_ = repairs.attribute   AND errors._value_ = repairs.rv_value with id 5
15:37:33 - [DEBUG] - Time to execute query with id 5: 0.00 secs
15:37:33 - [DEBUG] - Starting to execute query SELECT COUNT(*) FROM   (SELECT t2._tid_, t2._attribute_, t2._value_      FROM "beers_nwcpk_025" as t1, "beers_nwcpk_025_clean" as t2     WHERE t1._tid_ = t2._tid_       AND t2._attribute_ = 'brewery_id'       AND t1."brewery_id" != t2._value_ ) as errors, inf_values_dom as repairs WHERE errors._tid_ = repairs._tid_   AND errors._attribute_ = repairs.attribute   AND errors._value_ = repairs.rv_value with id 6
15:37:33 - [DEBUG] - Time to execute query with id 6: 0.00 secs
15:37:33 - [DEBUG] - Starting to execute query SELECT COUNT(*) FROM   (SELECT t2._tid_, t2._attribute_, t2._value_      FROM "beers_nwcpk_025" as t1, "beers_nwcpk_025_clean" as t2     WHERE t1._tid_ = t2._tid_       AND t2._attribute_ = 'brewery_name'       AND t1."brewery_name" != t2._value_ ) as errors, inf_values_dom as repairs WHERE errors._tid_ = repairs._tid_   AND errors._attribute_ = repairs.attribute   AND errors._value_ = repairs.rv_value with id 7
15:37:33 - [DEBUG] - Time to execute query with id 7: 0.00 secs
15:37:33 - [DEBUG] - Starting to execute query SELECT COUNT(*) FROM   (SELECT t2._tid_, t2._attribute_, t2._value_      FROM "beers_nwcpk_025" as t1, "beers_nwcpk_025_clean" as t2     WHERE t1._tid_ = t2._tid_       AND t2._attribute_ = 'city'       AND t1."city" != t2._value_ ) as errors, inf_values_dom as repairs WHERE errors._tid_ = repairs._tid_   AND errors._attribute_ = repairs.attribute   AND errors._value_ = repairs.rv_value with id 8
15:37:33 - [DEBUG] - Time to execute query with id 8: 0.00 secs
15:37:33 - [DEBUG] - Starting to execute query SELECT COUNT(*) FROM   (SELECT t2._tid_, t2._attribute_, t2._value_      FROM "beers_nwcpk_025" as t1, "beers_nwcpk_025_clean" as t2     WHERE t1._tid_ = t2._tid_       AND t2._attribute_ = 'state'       AND t1."state" != t2._value_ ) as errors, inf_values_dom as repairs WHERE errors._tid_ = repairs._tid_   AND errors._attribute_ = repairs.attribute   AND errors._value_ = repairs.rv_value with id 9
15:37:33 - [DEBUG] - Time to execute query with id 9: 0.00 secs
15:37:33 - [DEBUG] - Time to execute 10 queries: 0.01 secs
15:37:33 - [DEBUG] - Time to execute query: 0.00 secs
15:37:33 - [DEBUG] - weak label statistics:
15:37:33 - [DEBUG] -     is_clean  cell_status  is_inferred  init = grdth init = inferred  \
0   False     0            True         False         False            
1   False     0            True         False         False            
2   False     0            True         False         True             
3   False     0            True         True          True             
4   False     1            True         False         True             
5   False     1            True         True          True             
6   False     2            True         False         False            
7   False     2            True         True          True             
8   True      0            False        False         None             
9   True      0            False        True          None             
10  True      1            False        False         None             
11  True      1            False        True          None             
12  True      2            False        False         None             
13  True      2            False        True          None             

    w. label = init  w. label = grdth w. label = inferred infer = grdth  count  
0   True             False             False               False         1      
1   True             False             False               True          11     
2   True             False             True                False         42     
3   True             True              True                True          899    
4   False            False             False               False         1      
5   False            False             False               True          24     
6   True             False             False               True          6      
7   True             True              True                True          48     
8   True             False             None                None          2788   
9   True             True              None                None          12797  
10  False            False             None                None          1441   
11  False            False             None                None          45     
12  True             False             None                None          113    
13  True             True              None                None          2401   
15:37:33 - [ INFO] - Precision = 0.94, Recall = 0.00, Repairing Recall = 0.28, F1 = 0.01, Repairing F1 = 0.43, Detected Errors = 61, Total Errors = 4403, Correct Repairs = 17, Total Repairs = 763, Total Repairs on correct cells (Grdth present) = 0, Total Repairs on incorrect cells (Grdth present) = 18
15:37:33 - [DEBUG] - Time to generate report: 0.06 secs
15:37:33 - [DEBUG] - Time to execute query: 0.01 secs
15:37:34 - [ INFO] - 清洗后的数据已成功保存到 results/holoclean/nwcpk/3_beers_nwcpk_025/3_beers_nwcpk_025_repaired.csv
没有指定错误比例，仅进行原数据集的空值替换，不添加错误
已将注入错误的文件保存到: Data/3_beers/clean_index_ori_empty.csv
没有指定错误比例，仅进行原数据集的空值替换，不添加错误
已将注入错误的文件保存到: Data/3_beers/noise_with_correct_primary_key/dirty_mixed_0.25/dirty_beers_mix_0.25_ori_empty.csv
Running Holoclean with modified dirty file: Data/3_beers/noise_with_correct_primary_key/dirty_mixed_0.25/dirty_beers_mix_0.25_holoclean.csv
转换完成，结果已保存到 Data/3_beers/clean_index_holoclean.csv
Results saved to results/holoclean/nwcpk/3_beers_nwcpk_025/3_beers_nwcpk_025_repaired.csv
Holoclean finished in 220.67306399345398 seconds.
测评性能开始：
没有指定错误比例，仅进行原数据集的空值替换，不添加错误
已将注入错误的文件保存到: results/holoclean/nwcpk/3_beers_nwcpk_025/3_beers_nwcpk_025_repaired_ori_empty.csv
差异文件已保存到:
results/holoclean/nwcpk/3_beers_nwcpk_025/3_beers_nwcpk_025_clean_vs_dirty.csv
results/holoclean/nwcpk/3_beers_nwcpk_025/3_beers_nwcpk_025_dirty_vs_cleaned.csv
results/holoclean/nwcpk/3_beers_nwcpk_025/3_beers_nwcpk_025_clean_vs_cleaned.csv
修复错误数据文件已保存到: results/holoclean/nwcpk/3_beers_nwcpk_025/3_beers_nwcpk_025_repair_errors.csv
未修复但是应该修复数据文件已保存到: results/holoclean/nwcpk/3_beers_nwcpk_025/3_beers_nwcpk_025_unrepaired.csv
修复准确率: 0.017598343685300208, 修复召回率: 0.10365853658536585, F1值: 0.030088495550407393
========================================
EDR 结果已保存到: results/holoclean/nwcpk/3_beers_nwcpk_025/3_beers_nwcpk_025_edr_evaluation.txt
错误减少率 (EDR): -5.676829268292683
========================================
混合距离结果已保存到: results/holoclean/nwcpk/3_beers_nwcpk_025/3_beers_nwcpk_025_hybrid_distance_evaluation.txt
混合距离 (Hybrid Distance): 0.03241204043853463
========================================
R-EDR 结果已保存到: results/holoclean/nwcpk/3_beers_nwcpk_025/3_beers_nwcpk_025_record_based_edr_evaluation.txt
基于条目的错误减少率 (R-EDR): -5.483221476510067
========================================
测试结果:
Accuracy: 0.017598343685300208
Recall: 0.10365853658536585
F1 Score: 0.030088495550407393
EDR: -5.676829268292683
Hybrid Distance: 0.03241204043853463
R-EDR: -5.483221476510067
Time: 220.67306399345398
Speed: 9.15655867192755 seconds/100 records
测评结束，详细测评日志见：results/holoclean/nwcpk/3_beers_nwcpk_025
